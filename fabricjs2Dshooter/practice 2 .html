<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Shooter Game with Images and Sound</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.5.0/fabric.min.js"></script>
    <style>
        canvas {
            border: 1px solid black;
        }
        #controls, #hud {
            font-family: Arial, sans-serif;
            margin-top: 10px;
        }
        #controls button {
            margin-right: 10px;
        }
        #hud span {
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="hud">
        <span>Score: <span id="score">0</span></span>
        <span>Lives: <span id="lives">3</span></span>
    </div>
    <div id="controls">
        <button id="startButton">Start</button>
        <button id="stopButton" disabled>Stop</button>
    </div>
    <script>
        // Complete game logic, including shooter movement, collision handling, sound integration, etc.
        const canvas = new fabric.Canvas('gameCanvas');

        // Set up a background image
        fabric.Image.fromURL('https://github.com/ntriolo/ntriolo.github.io/blob/main/fabricjs2Dshooter/caveman%20background.jpeg?raw=true', function(img) {
            img.scaleToWidth(canvas.width);
            img.scaleToHeight(canvas.height);
            canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));
        });

        const shootSound = new Audio('bow-release-bow-and-arrow-4-101936.mp3');
        const hitSound = new Audio('arrow-impact-87260.mp3');
        const backgroundMusic = new Audio('https://example.com/background-music.mp3'); 

        backgroundMusic.loop = true;
        backgroundMusic.volume = 0.5;

        let shooter;
        const bullets = [];
        const enemies = [];
        let score = 0;
        let lives = 3;
        let gameRunning = false;
        let gameLoopId = null;
        let enemyIntervalId = null;

        function updateHUD() {
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
        }

        fabric.Image.fromURL('https://github.com/ntriolo/ntriolo.github.io/blob/main/fabricjs2Dshooter/caveman-removebg-preview.png?raw=true', function(img) {
            shooter = img.set({
                left: 50,
                top: canvas.height / 2 - 25,
                originX: 'center',
                originY: 'center',
                scaleX: 0.1,
                scaleY: 0.1
            });
            canvas.add(shooter);
        });

        let isMovingUp = false, isMovingDown = false, isMovingLeft = false, isMovingRight = false;

        function moveShooter() {
            if (!shooter) return;

            const step = 5;
            if (isMovingUp && shooter.top > 0) shooter.top -= step;
            if (isMovingDown && shooter.top < canvas.height - shooter.height * shooter.scaleY) shooter.top += step;
            if (isMovingLeft && shooter.left > 0) shooter.left -= step;
            if (isMovingRight && shooter.left < canvas.width - shooter.width * shooter.scaleX) shooter.left += step;

            shooter.setCoords();
            canvas.renderAll();
            if (isMovingUp || isMovingDown || isMovingLeft || isMovingRight) requestAnimationFrame(moveShooter);
        }

        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            if (e.key === 'ArrowUp') isMovingUp = true;
            if (e.key === 'ArrowDown') isMovingDown = true;
            if (e.key === 'ArrowLeft') isMovingLeft = true;
            if (e.key === 'ArrowRight') isMovingRight = true;
            if (e.key === ' ') shoot();
            moveShooter();
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowUp') isMovingUp = false;
            if (e.key === 'ArrowDown') isMovingDown = false;
            if (e.key === 'ArrowLeft') isMovingLeft = false;
            if (e.key === 'ArrowRight') isMovingRight = false;
        });

        function shoot() {
            if (!shooter) return;

            fabric.Image.fromURL('https://github.com/ntriolo/ntriolo.github.io/blob/main/fabricjs2Dshooter/arrow-removebg-preview.png?raw=true', function(img) {
                img.scaleToWidth(20);
                img.set({
                    left: shooter.left + (shooter.width * shooter.scaleX) / 2,
                    top: shooter.top,
                    originX: 'center',
                    originY: 'center'
                });
                bullets.push(img);
                canvas.add(img);

                function moveBullet() {
                    if (img.left < canvas.width) {
                        img.left += 10;
                        img.setCoords();
                        canvas.renderAll();
                        requestAnimationFrame(moveBullet);
                    } else {
                        canvas.remove(img);
                        bullets.splice(bullets.indexOf(img), 1);
                    }
                }
                moveBullet();
            });
            shootSound.play();
        }

        function createEnemy() {
            fabric.Image.fromURL('https://github.com/ntriolo/ntriolo.github.io/blob/main/fabricjs2Dshooter/pig-removebg-preview.png?raw=true', function(img) {
                const enemy = img.set({
                    left: canvas.width,
                    top: Math.random() * (canvas.height - 50),
                    originX: 'center',
                    originY: 'center',
                    scaleX: 0.2,
                    scaleY: 0.2
                });
                enemies.push(enemy);
                canvas.add(enemy);
            });
        }

        function gameLoop() {
            updateBullets();
            updateEnemies();
            checkCollisions();
            canvas.renderAll();
            if (gameRunning) requestAnimationFrame(gameLoop);
        }

        function updateBullets() { /* Logic */ }
        function updateEnemies() { /* Logic */ }
        function checkCollisions() { /* Logic */ }

        function startGame() {
            if (!gameRunning) {
                gameRunning = true;
                backgroundMusic.play();
                gameLoopId = requestAnimationFrame(gameLoop);
                enemyIntervalId = setInterval(createEnemy, 2000);
            }
        }

        function stopGame() { /* Logic */ }

        document.getElementById('startButton').addEventListener('click', startGame);
        document.getElementById('stopButton').addEventListener('click', stopGame);

        updateHUD();
    </script>
</body>
</html>
